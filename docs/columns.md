
    Phase 1: Environment Configuration (5 minutes)                                                                                                                                                                                                                             │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ File: .env                                                                                                                                                                                                                                                                 │ │
│ │ 1. Copy .env.example to .env                                                                                                                                                                                                                                               │ │
│ │ 2. Set MOCK_ERP_DATA=False (enable real ERP)                                                                                                                                                                                                                               │ │
│ │ 3. Set MCP_SERVER_URL=http://localhost:5173                                                                                                                                                                                                                                │ │
│ │ 4. Set MCP_API_KEY=your-mcp-api-key                                                                                                                                                                                                                                        │ │
│ │ 5. Verify other required settings are configured                                                                                                                                                                                                                           │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Phase 2: Update Forecast Unification Phase (15 minutes)                                                                                                                                                                                                                    │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ File: src/engine/planning/phases/forecast_unification.py                                                                                                                                                                                                                   │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Current Issue: Lines 91-101 use hardcoded mock data                                                                                                                                                                                                                        │ │
│ │ Solution: Replace mock data methods with ERP MCP calls                                                                                                                                                                                                                     │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ 1. Import ERP client: from src.data.connectors.erp_mcp_client import ERPMCPClient                                                                                                                                                                                          │ │
│ │ 2. Replace _get_erp_forecast() method:                                                                                                                                                                                                                                     │ │
│ │   - Remove hardcoded values on lines 94-100                                                                                                                                                                                                                                │ │
│ │   - Add async ERP client connection                                                                                                                                                                                                                                        │ │
│ │   - Call client.get_sales_forecast()                                                                                                                                                                                                                                       │ │
│ │   - Parse DataFrame response to extract forecast for product_id                                                                                                                                                                                                            │ │
│ │   - Add error handling with fallback to default value                                                                                                                                                                                                                      │ │
│ │ 3. Update _get_sales_forecast() method:                                                                                                                                                                                                                                    │ │
│ │   - Connect to ERP MCP client                                                                                                                                                                                                                                              │ │
│ │   - Pull from sales_order_plan endpoint                                                                                                                                                                                                                                    │ │
│ │   - Filter by product_id and return quantity                                                                                                                                                                                                                               │ │
│ │ 4. Add configuration check:                                                                                                                                                                                                                                                │ │
│ │   - Read MOCK_ERP_DATA from settings                                                                                                                                                                                                                                       │ │
│ │   - Only use ERP if MOCK_ERP_DATA=False                                                                                                                                                                                                                                    │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Phase 3: Update BOM Explosion Phase (20 minutes)                                                                                                                                                                                                                           │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ File: src/engine/planning/phases/bom_explosion.py                                                                                                                                                                                                                          │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Current Issue: Lines 18-40 use hardcoded mock BOMs                                                                                                                                                                                                                         │ │
│ │ Solution: Replace with ERP BOM data                                                                                                                                                                                                                                        │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ 1. Import ERP client                                                                                                                                                                                                                                                       │ │
│ │ 2. Replace mock_boms dictionary initialization:                                                                                                                                                                                                                            │ │
│ │   - Add async _load_bom_data() method                                                                                                                                                                                                                                      │ │
│ │   - Call client.pull_all_pages("bom")                                                                                                                                                                                                                                      │ │
│ │   - Transform ERP BOM structure to internal format                                                                                                                                                                                                                         │ │
│ │   - Cache BOMs in instance variable                                                                                                                                                                                                                                        │ │
│ │ 3. Update execute() method:                                                                                                                                                                                                                                                │ │
│ │   - Call await _load_bom_data() at start                                                                                                                                                                                                                                   │ │
│ │   - Replace BOM lookup from mock_boms with loaded ERP data                                                                                                                                                                                                                 │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Phase 4: Update Inventory Netting Phase (20 minutes)                                                                                                                                                                                                                       │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ File: src/engine/planning/phases/inventory_netting.py                                                                                                                                                                                                                      │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Expected Issue: Currently uses mock inventory data                                                                                                                                                                                                                         │ │
│ │ Solution: Connect to ERP inventory endpoint                                                                                                                                                                                                                                │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ 1. Add ERP client integration                                                                                                                                                                                                                                              │ │
│ │ 2. Replace mock inventory data with:                                                                                                                                                                                                                                       │ │
│ │   - Call client.get_current_inventory()                                                                                                                                                                                                                                    │ │
│ │   - Parse DataFrame to get inventory levels by material                                                                                                                                                                                                                    │ │
│ │   - Handle missing inventory records gracefully                                                                                                                                                                                                                            │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Phase 5: Update Procurement & Supplier Phases (20 minutes)                                                                                                                                                                                                                 │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Files:                                                                                                                                                                                                                                                                     │ │
│ │ - src/engine/planning/phases/procurement_optimization.py                                                                                                                                                                                                                   │ │
│ │ - src/engine/planning/phases/supplier_selection.py                                                                                                                                                                                                                         │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ 1. Procurement: Connect to supplier pricing data from ERP                                                                                                                                                                                                                  │ │
│ │ 2. Supplier Selection: Use real supplier data from suppliers endpoint                                                                                                                                                                                                      │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Phase 6: Integration Testing (10 minutes)                                                                                                                                                                                                                                  │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ 1. Test full data flow from ERP through all 6 phases                                                                                                                                                                                                                       │ │
│ │ 2. Verify planning results use real Beverly Knits data                                                                                                                                                                                                                     │ │
│ │ 3. Check error handling when ERP unavailable                                                                                                                                                                                                                               │ │
│ │ 4. Validate data transformations are correct                                                                                                                                                                                                                               │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Phase 7: Configuration & Error Handling (10 minutes)                                                                                                                                                                                                                       │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ 1. Add robust error handling for ERP connection failures                                                                                                                                                                                                                   │ │
│ │ 2. Implement graceful fallback to mock data when ERP down                                                                                                                                                                                                                  │ │
│ │ 3. Add logging for data flow debugging                                                                                                                                                                                                                                     │ │
│ │ 4. Test with invalid/missing ERP data scenarios                                                                                                                                                                                                                            │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Total Time Estimate: 100 minutes (1 hour 40 minutes)                                                                                                                                                                                                                       │ │
│ │                                                                                                                                                                                                                                                                            │ │
│ │ Success Criteria:                                                                                                                                                                                                                                                          │ │
│ │ - Planning engine pulls real data from Beverly Knits ERP                                                                                                                                                                                                                   │ │
│ │ - All 6 phases use ERP data instead of mock data                                                                                                                                                                                                                           │ │
│ │ - Graceful fallback when ERP unavailable                                                                                                                                                                                                                                   │ │
│ │ - End-to-end planning produces accurate results with real data                                                                                                                                                                                                             │ │
│ ╰───────────────────────────────────